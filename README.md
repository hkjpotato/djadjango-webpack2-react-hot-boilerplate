# django-webpack2-react-hot-boilerplate
This boilerplate is based on Owais Lone's article [Using Webpack transparently with Django + hot reloading React components as a bonus](http://owaislone.org/blog/webpack-plus-reactjs-and-django/). I modify it for webpack2 and make some minor changes. You will need to install [django-webpack-loader](https://github.com/ezhome/django-webpack-loader) for Django  and [webpack-bundle-tracker](https://github.com/ezhome/webpack-bundle-tracker) for webpack.

### Basic
The bridge is the webpack-stats.json, it is a map between entry name and its bundle file.
Notice:
1. webpack-stats.json is the ONLY file django knows about those static files.
2. It is generated by webpack-bundle-tracker plugin when you run webpack, nothing to do with django.

The actual path injected to the template is generated by WEBPACK_LOADER in django, using that json file.
- case1: json file has no publicPath, the actual url is ```STATIC_URL(in django) + BUNDLE_DIR_NAME(here)E + BUNDLE_FILE_NAME(json, the name of chunk)```
- case2: json file has publicPath, then it will use the publicPath for the injected url in django template.

### Notice

##### About development and production
Don't be confused by development/production modes in webpack and django, production in webpack(frontend) does not mean production in django(backend). The __DEBUG__ flag in django ```settings.py``` only means the debug mode of django, it will affects how django [serves static files during development](
https://docs.djangoproject.com/en/1.10/howto/static-files/)

If ```DEBUG=True```, django will serve static files from directory defined ```STATICFILES_DIRS```, that’s why you need to add ‘assets' directory to it.

##### Also about publicPath
If you don’t specify publicPath in webpack configuration, django will use the BUNDLE_DIR_NAME to decide directory of the bundle files. However, it is always good to set publicPath especially if you want to do code splitting.
  
And if you are using WDS to serve your static files, you need to write publicPath with domain name included (e.g. http://localhost:3000/assets/bundles/), so that HMR runtime will be able to load updated components from WDS.

I use a flag called ```WDS_ON``` in ```settings.py``` to switch from using webpack-stats.json to webpack-stats-prod.json, and let django(if ```DEBUG = True```) to serve static files in ```/assets/build```.

##### About ‘Access-Control-Allow-Origin' for WDS
Since your django serve the index.html (domain is localhost:8000), and
static files are served by WDS. HMR runtime (loaded in the browser at domain localhost:8000) will try to load updated bundles from WDS (localhost:3000).
Thus you need to add localhost:8000 to the "Access-Control-Allow-Origin” of the WDS’s headers.

##### About ‘proxy’ for WDS:
If your data api is serving by another server (which is better), you need to set proxy due to CORS. If your data api is also served by this django application (say you are developing a small app), you don’t need to worry about it.

##### About passing django's context variables to React:
If you are doing client side rendering with React, context variables cannot be accessed directly in your React App. Here are two suggestions, both rely on the global ‘window’ as a glue:
 - check __app1__: In this approach, Load bundles first, which defines an init function. Then in your template, call this init function with context variables. More explanation is [here](https://stackoverflow.com/questions/28610372/reactjs-with-django-real-usage)
 - check __app2__: Just attach the context variable to the global windows first, then load bundles to access it from ‘windows’.

### Additional Guide
Make sure Node and NPM is installed(https://github.com/creationix/nvm). I use node 6 now.

Setup virtualenv if you want
->to install: pip install -r requirements.txt
->two things to be installed:
Django==1.10
django-webpack-loader==0.5.0